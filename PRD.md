# AdScriptGen 产品需求文档 (PRD)

## 1. 产品概述 (Introduction)

### 1.1 产品名称
**AdScriptGen** (AI 广告脚本生成器)

### 1.2 产品定位
一款面向游戏营销、广告投放人员的效能工具。利用生成式 AI (Gemini) 的能力，根据用户输入的参数，自动生成结构化、高转化的移动游戏视频广告分镜脚本。

### 1.3 目标用户
- 游戏广告投放师 (UA Buyers)
- 视频创意设计师 (Creative Designers)
- 独立游戏开发者 (Indie Developers)

---

## 2. 核心功能 (Core Features)

### 2.1 脚本配置与生成 (Configuration & Generation)
- **多维度参数配置**: 用户可通过左侧面板配置以下参数：
  - **模型选择**: 支持切换不同的 Gemini 模型 (如 1.5 Flash)。
  - **游戏名称**: 自定义目标游戏名称。
  - **视频时长**: 提供 **15秒** 和 **30秒** 快捷选项，系统自动计算预估分镜数。
  - **创意维度**: 包含视觉主题、运镜视角、核心交互、文案钩子、音频设计、剧本流程、结尾方式等。
- **流式生成 (Streaming)**: 点击生成后，界面实时打字机式展示 AI 思考与生成过程，减少等待焦虑。
- **结构化输出**: 生成结果以卡片形式展示，包含：
  - **策略分析**: AI 对当前脚本的心理学策略解读。
  - **分镜详情**: 每个分镜的时间段、画面描述、音效提示、交互指令及文案。

### 2.2 历史记录管理 (History Management)
- **自动保存**: 生成成功的脚本会自动保存。
- **混合存储架构**:
  - **优先**: 尝试存储于后端数据库 (SQLite)。
  - **降级**: 若后端不可用 (如 Cloudflare/Vercel 环境)，自动无缝切换至浏览器 **LocalStorage**。
- **管理操作**:
  - **查看**: 点击历史列表项回填内容。
  - **重命名**: 支持修改脚本标题。
  - **删除**: 支持删除废弃脚本。

### 2.3 后台配置管理 (Admin Configuration)
- **动态配置**: 提供 `/admin/config` 管理页面。
- **字段管理**: 管理员可新增、编辑、删除左侧面板的下拉选项 (如新增一种“赛博朋克”风格)。
- **默认值保护**: 系统内置硬编码的默认配置，确保在无数据库或网络异常时，前端依然可用。

---

## 3. 用户体验 (UI/UX)

- **布局**: 经典的三栏式布局 (配置栏 - 内容展示栏 - 历史记录栏)。
- **交互**:
  - 下拉菜单支持单选，操作后自动收起。
  - 生成过程中伴随脉冲动画。
  - 响应式设计，适配不同屏幕尺寸。
- **语言**: 强制 AI 输出 **简体中文** 内容，符合国内投放习惯。

---

## 4. 技术架构 (Technical Architecture)

### 4.1 技术栈
- **框架**: Next.js 15 (App Router)
- **语言**: TypeScript
- **样式**: Tailwind CSS
- **AI 模型**: Google Gemini API (generative-ai)
- **ORM**: Prisma
- **数据库**: SQLite (本地/开发环境)

### 4.2 Serverless & Edge 适配
本产品针对 **Cloudflare Pages** 和 **Vercel** 进行了深度适配：
- **Edge Runtime**: API 路由配置为 `runtime = 'edge'`，确保全球访问速度。
- **无数据库模式**: 能够智能检测运行环境，在不支持文件系统写入的 Serverless 环境中，自动屏蔽数据库报错，转而使用纯前端逻辑运行。

---

## 5. 部署说明 (Deployment)

### 5.1 环境变量
无需复杂的服务器端环境变量配置，API Key 由用户在前端动态输入，保障安全性与灵活性。

### 5.2 推荐平台
- **Cloudflare Pages**: 无文件数量限制，完全兼容 Edge 模式。
- **Vercel**: 支持，需注意免费版的文件数量限制 (已通过 `.vercelignore` 优化)。

---

## 6. 未来规划 (Roadmap)

- [ ] **多语言支持**: 增加英文、日文等输出选项，适配出海需求。
- [ ] **图片生成**: 对接 Midjourney/Stable Diffusion，根据分镜描述自动生成参考分镜图。
- [ ] **导出功能**: 支持将脚本导出为 Excel (.xlsx) 或 PDF 格式。
- [ ] **团队协作**: 增加用户账户体系，支持团队内共享脚本库。
